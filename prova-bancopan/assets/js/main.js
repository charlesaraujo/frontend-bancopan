(()=>{"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function n(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}var s=function(){function e(n){t(this,e),this.users=n,this.usersContainer=document.getElementById("users")}return n(e,[{key:"createTemplate",value:function(){this.usersContainer.innerHTML="";for(var t=0;t<this.users.length;t++){var e=this.templateModel(this.users[t]);this.usersContainer.innerHTML+=e}}},{key:"templateModel",value:function(t){var e=new a;return'<li class="user">\n        <h2 class="name">'.concat(t.name,"</h2>\n        <p><strong>CPF:</strong> ").concat(e.formatCPF(t.cpf),"</p>\n        <p><strong>E-mail:</strong> ").concat(t.email,"</p>\n        <p><strong>Telefone:</strong> ").concat(e.formatPhone(t.phone),'</p>\n        <div class="area-buttons">\n            <button class="btn btn-small btn-edit" data-button="edit" data-user="').concat(t.cpf,'">\n                <svg width="12" height="14" viewBox="0 0 12 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n                    <path d="M10.5 14L12 12.5L9.98 8L10 6H8.86L6 0L3 6H1.98V8L0 12.5L1.5 14L3 8H9L10.5 14Z" fill="white"/>\n                </svg>\n            </button>\n            <button class="btn btn-small btn-delete" data-button="delete" data-user="').concat(t.cpf,'">\n                <svg width="8" height="8" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M42 4.23L37.77 0L21 16.77L4.23 0L0 4.23L16.77 21L0 37.77L4.23 42L21 25.23L37.77 42L42 37.77L25.23 21L42 4.23Z" fill="white"/>\n                </svg>\n            </button>\n        </div>\n    </li>')}},{key:"init",value:function(){return this.createTemplate(),this}}]),e}(),i=function(){function e(n,s){t(this,e),this.storageName="listUsers",this.listUsers=[],this.url=n,this.userDiv=document.getElementById(s),this.titleModal=document.querySelectorAll(".text-change"),this.deleteUser=this.deleteUser.bind(this)}return n(e,[{key:"getDataFetch",value:function(){var t=this;fetch(this.url).then((function(t){return t.json()})).then((function(e){t.setStorageUsers(e),t.templateUsers(e)}))}},{key:"setStorageUsers",value:function(t){this.listUsers=t,localStorage.setItem(this.storageName,JSON.stringify(t))}},{key:"getStorageUsers",value:function(){var t=localStorage.getItem(this.storageName);return JSON.parse(t)}},{key:"templateUsers",value:function(t){new s(t).init(),this.userEvents()}},{key:"getUser",value:function(t){var e=this.getStorageUsers().find((function(e){return e.cpf===t}));(new r).modalWindow.classList.toggle("active"),document.getElementById("name").value=e.name,document.getElementById("email").value=e.email,document.getElementById("cpf").value=e.cpf,document.getElementById("phone").value=e.phone}},{key:"createUser",value:function(t){var e=this.getStorageUsers();e.push(t),this.templateUsers(e),this.setStorageUsers(e),(new r).modalWindow.classList.toggle("active")}},{key:"editUser",value:function(t){var e=this.getStorageUsers().map((function(e){return e.cpf===t.cpf&&(e.name=t.name,e.email=t.email,e.phone=t.phone),e}));this.templateUsers(e),this.setStorageUsers(e),(new r).modalWindow.classList.toggle("active")}},{key:"deleteUser",value:function(t){this.users=this.getStorageUsers().filter((function(e){return e.cpf!==t})),this.setStorageUsers(this.users),this.templateUsers(this.users)}},{key:"userEvents",value:function(){var t=this;this.buttonDelete=document.querySelectorAll('[data-button="delete"]'),this.buttonEdit=document.querySelectorAll('[data-button="edit"]'),this.buttonDelete.forEach((function(e){return e.addEventListener("click",(function(){return t.deleteUser(e.getAttribute("data-user"))}))})),this.buttonEdit.forEach((function(e){return e.addEventListener("click",(function(){t.getUser(e.getAttribute("data-user")),t.titleModal.forEach((function(t){t.innerHTML="Atualizar usuário"})),document.getElementById("submit").disabled=!1}))}))}},{key:"init",value:function(){if(this.getStorageUsers()&&0!==this.getStorageUsers().length){var t=this.getStorageUsers();this.templateUsers(t)}else this.getDataFetch(this.url);return this}}]),e}(),a=function(){function e(){t(this,e),this.form=document.getElementById("form"),this.msg=document.getElementById("msg"),this.inputs=document.querySelectorAll("input"),this.submit=document.getElementById("submit"),this.validateInput=this.validateInput.bind(this),this.inputError=0}return n(e,[{key:"submitForm",value:function(){this.form.addEventListener("submit",(function(t){var e={name:document.getElementById("name").value,email:document.getElementById("email").value,cpf:document.getElementById("cpf").value,phone:document.getElementById("phone").value},n=new i;t.preventDefault(),n.getStorageUsers().find((function(t){return t.cpf===e.cpf}))?n.editUser(e):n.createUser(e)}))}},{key:"eventInputs",value:function(){var t=this;this.inputs.forEach((function(e){e.addEventListener("blur",(function(){return t.validateInput(e)}))}))}},{key:"feedback",value:function(){var t=this;this.inputs.forEach((function(e){0===e.value.length?t.inputError=1:t.inputError=0})),0===this.inputError?(this.msg.innerHTML="",this.submit.disabled=!1):(this.msg.innerHTML="Os campos abaixo ser preenchidos",this.submit.disabled=!0)}},{key:"validateInput",value:function(t){0!==t.value.length?(t.classList.remove("input-error"),t.classList.add("input-success")):(t.classList.add("input-error"),t.classList.remove("input-success")),this.feedback()}},{key:"clearForm",value:function(){this.inputs.forEach((function(t){t.value=""}))}},{key:"formatCPF",value:function(t){return t.replace(/\D/g,"").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})/,"$1-$2").replace(/(-\d{2})\d+?$/,"$1")}},{key:"formatPhone",value:function(t){return t.replace(/\D/g,"").replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{5})(\d{4})(\d)/,"$1-$2").replace(/(-\d{4})(\d+?)$/,"$1")}},{key:"init",value:function(){this.eventInputs(),this.submitForm()}}]),e}(),r=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:'[data-modal="button"]',s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:'[data-modal="modal"]',i=arguments.length>2?arguments[2]:void 0;t(this,e),this.modalButton=document.querySelectorAll(n),this.modalWindow=document.querySelector(s),this.titleModal=document.querySelectorAll(".text-change"),this.activeClass="active",this.events=void 0===i?["click"]:i,this.eventModal=this.eventModal.bind(this)}return n(e,[{key:"eventModal",value:function(){var t=this;this.modalWindow.classList.toggle(this.activeClass),this.modalButton.forEach((function(e){return e.classList.toggle(t.activeClass)})),this.titleModal.forEach((function(t){t.innerHTML="Cadastrar usuário"})),(new a).clearForm()}},{key:"addModalEvents",value:function(){var t=this;this.events.forEach((function(e){return t.modalButton.forEach((function(n){n.addEventListener(e,t.eventModal)}))}))}},{key:"init",value:function(){return this.modalButton&&this.modalWindow&&this.addModalEvents(),this}}]),e}();new r('[data-modal="button"]','[data-modal="modal"]',["click"]).init(),new i("https://private-56d1e-charlesaraujodasilva.apiary-mock.com/users","users").init(),(new a).init()})();